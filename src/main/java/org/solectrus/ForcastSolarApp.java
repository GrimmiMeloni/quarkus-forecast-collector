package org.solectrus;

import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import java.util.concurrent.CompletionStage;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

import javax.enterprise.context.ApplicationScoped;
import javax.inject.Inject;
import javax.ws.rs.client.Client;
import javax.ws.rs.client.ClientBuilder;

import org.eclipse.microprofile.config.inject.ConfigProperty;
import org.jboss.logging.Logger;
import org.solectrus.config.ForecastConfiguration;
import org.solectrus.influx.DataServiceException;
import org.solectrus.influx.DataServiceInterface;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.ibm.asyncutil.util.StageSupport;

import io.quarkus.scheduler.Scheduled;

@ApplicationScoped
public class ForcastSolarApp {

    @Inject
    Logger logger;

    @Inject 
    ForecastConfiguration forecastConfiguration;
    
    @Inject
    DataServiceInterface dataSvc;

    @Inject
    ObjectMapper mapper;

    private ExecutorService executorService = Executors.newCachedThreadPool();
    private Client client;
    private String baseUrl;

    @Inject
    @ConfigProperty(name = "simulate.forecast", defaultValue = "false")
    boolean configSimulateForecast;
    
    @Inject
    @ConfigProperty(name = "write.to.influxdb", defaultValue = "true")
    boolean configWriteToInfluxDb;
    
    @Inject
    @ConfigProperty(name = "forecast.interval")
    String forecastInterval;
    
    private static final DateTimeFormatter LOCAL_DATE_TIME_FORMAT = DateTimeFormatter.ofPattern("YYYY-MM-dd HH:mm:ss");
    
    @Inject
    public void PostResourceClient() {
        baseUrl = "https://api.forecast.solar";
        client = ClientBuilder.newBuilder().executorService(executorService).build();
    }

    @Scheduled(every = "{forecast.interval}")
    public void execute() {
        
        String executionTime = LocalDateTime.now().format(LOCAL_DATE_TIME_FORMAT); 
        
        String method = (configSimulateForecast) ? "simulating" : "querying";

        logger.infof("[%s] %s forecast data, interval: %s", executionTime, method, forecastInterval);

        Map<String, Integer> totalForecastData = new HashMap<>();
        
        for(String configurationName : forecastConfiguration.getForecastConfigurationNames()) {
            Map<String, Integer> forecastData = getForecastDataFor(executionTime, configurationName);
            
            consolidateForecastData(forecastData, totalForecastData);
        }

        logger.trace(totalForecastData.toString());

        for (Map.Entry<String, Integer> currentWattEntry : totalForecastData.entrySet()) {
            try {
                Forecast forecast = dataSvc.createForecastData(currentWattEntry.getKey(), currentWattEntry.getValue(), configWriteToInfluxDb);
                logger.debugf("Forecast: %s", forecast);
            } catch (DataServiceException e) {
                logger.warnf(e, "Unable to write ForecastData '%s' to InfluxDB", currentWattEntry.toString());
            }
        }
    }
    
    private Map<String, Integer> getForecastDataFor(String executionTime, String configurationName) {
        
        Map<String, Integer> forecastDataMap = new HashMap<>();

        CompletionStage<String> responseFuture;
        String response;
        
        if (configSimulateForecast) {
            responseFuture = responseSimulator();
        } else {
            responseFuture = client.target(baseUrl + //
                    forecastConfiguration.getUri(configurationName) //
            ).request().rx().get(String.class);
        }

        try {
            response = responseFuture.toCompletableFuture().get();
        } catch (Exception e) {
            logger.warnf(e, "Unable to get ForecastData for configuration '%s'", configurationName);
            return forecastDataMap;
        }
        
        // log the raw JSON response
        logger.infof("// %skWp / [%s] [%s] %s", forecastConfiguration.getKwp(configurationName), executionTime, configurationName, response);
        
        JsonNode jsonNode;
        try {
            jsonNode = mapper.readTree(response);
        } catch (Exception e) {
            logger.warnf(e, "Unable to parse response '%s'", response);
            return forecastDataMap;
        }

        logger.warnf("%s", jsonNode.toPrettyString());
        
        Iterator<Map.Entry<String, JsonNode>> entryIterator =  jsonNode.get("result").get("watts").fields();

        while (entryIterator.hasNext()) {
            Map.Entry<String, JsonNode> entry = entryIterator.next();

            final String currentTime = entry.getKey();
            final Integer currentWatt = Integer.valueOf(entry.getValue().asText());

            forecastDataMap.put(currentTime, currentWatt);
        }
        
        return forecastDataMap;
    }


    private void consolidateForecastData(Map<String, Integer> currentForecastData,
            Map<String, Integer> consolidatedForecastData ) {

        for(Map.Entry<String, Integer> entry : currentForecastData.entrySet() ) {

            final String currentTime = entry.getKey();
            final Integer currentWatt = entry.getValue();

            Integer wattSum = consolidatedForecastData.get(currentTime);

            if (wattSum == null) {
                logger.debugf("time: %s, (current) watt: %d", currentTime, currentWatt);
                consolidatedForecastData.put(currentTime, currentWatt);
            } else {
                wattSum = wattSum.intValue() + currentWatt.intValue();
                logger.debugf("time: %s, (current) watt: %d, (new) watt: %d", currentTime, currentWatt, wattSum);
                consolidatedForecastData.put(currentTime, wattSum);
            }
        }
    }

    private CompletionStage<String> responseSimulator() {

//        // 20210831 - 10kWp
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-08-30T06:28:00+02:00\":0,\"2021-08-30T06:44:00+02:00\":0,\"2021-08-30T07:00:00+02:00\":0,\"2021-08-30T08:00:00+02:00\":154,\"2021-08-30T09:00:00+02:00\":692,\"2021-08-30T10:00:00+02:00\":1507,\"2021-08-30T11:00:00+02:00\":2352,\"2021-08-30T12:00:00+02:00\":3075,\"2021-08-30T13:00:00+02:00\":3536,\"2021-08-30T14:00:00+02:00\":3705,\"2021-08-30T15:00:00+02:00\":3567,\"2021-08-30T16:00:00+02:00\":3137,\"2021-08-30T17:00:00+02:00\":2491,\"2021-08-30T18:00:00+02:00\":1799,\"2021-08-30T19:00:00+02:00\":984,\"2021-08-30T20:00:00+02:00\":231,\"2021-08-30T20:12:00+02:00\":31,\"2021-08-30T20:24:00+02:00\":0,\"2021-08-31T06:29:00+02:00\":0,\"2021-08-31T06:45:00+02:00\":0,\"2021-08-31T07:00:00+02:00\":15,\"2021-08-31T08:00:00+02:00\":246,\"2021-08-31T09:00:00+02:00\":1230,\"2021-08-31T10:00:00+02:00\":2860,\"2021-08-31T11:00:00+02:00\":4689,\"2021-08-31T12:00:00+02:00\":6181,\"2021-08-31T13:00:00+02:00\":6827,\"2021-08-31T14:00:00+02:00\":6750,\"2021-08-31T15:00:00+02:00\":5858,\"2021-08-31T16:00:00+02:00\":4336,\"2021-08-31T17:00:00+02:00\":2798,\"2021-08-31T18:00:00+02:00\":1860,\"2021-08-31T19:00:00+02:00\":1046,\"2021-08-31T20:00:00+02:00\":215,\"2021-08-31T20:11:00+02:00\":31,\"2021-08-31T20:22:00+02:00\":0},\"watt_hours\":{\"2021-08-30T06:28:00+02:00\":0,\"2021-08-30T06:44:00+02:00\":0,\"2021-08-30T07:00:00+02:00\":0,\"2021-08-30T08:00:00+02:00\":154,\"2021-08-30T09:00:00+02:00\":846,\"2021-08-30T10:00:00+02:00\":2353,\"2021-08-30T11:00:00+02:00\":4705,\"2021-08-30T12:00:00+02:00\":7780,\"2021-08-30T13:00:00+02:00\":11316,\"2021-08-30T14:00:00+02:00\":15021,\"2021-08-30T15:00:00+02:00\":18588,\"2021-08-30T16:00:00+02:00\":21725,\"2021-08-30T17:00:00+02:00\":24216,\"2021-08-30T18:00:00+02:00\":26015,\"2021-08-30T19:00:00+02:00\":26999,\"2021-08-30T20:00:00+02:00\":27230,\"2021-08-30T20:12:00+02:00\":27236,\"2021-08-30T20:24:00+02:00\":27236,\"2021-08-31T06:29:00+02:00\":0,\"2021-08-31T06:45:00+02:00\":0,\"2021-08-31T07:00:00+02:00\":4,\"2021-08-31T08:00:00+02:00\":250,\"2021-08-31T09:00:00+02:00\":1480,\"2021-08-31T10:00:00+02:00\":4340,\"2021-08-31T11:00:00+02:00\":9029,\"2021-08-31T12:00:00+02:00\":15210,\"2021-08-31T13:00:00+02:00\":22037,\"2021-08-31T14:00:00+02:00\":28787,\"2021-08-31T15:00:00+02:00\":34645,\"2021-08-31T16:00:00+02:00\":38981,\"2021-08-31T17:00:00+02:00\":41779,\"2021-08-31T18:00:00+02:00\":43639,\"2021-08-31T19:00:00+02:00\":44685,\"2021-08-31T20:00:00+02:00\":44900,\"2021-08-31T20:11:00+02:00\":44905,\"2021-08-31T20:22:00+02:00\":44905},\"watt_hours_day\":{\"2021-08-30T02:00:00+02:00\":27236,\"2021-08-31T02:00:00+02:00\":44905}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":10}}}");

//        // 20210901 - 11kWp / afternoon
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-01T06:31:00+02:00\":0,\"2021-09-01T06:46:00+02:00\":11,\"2021-09-01T07:00:00+02:00\":40,\"2021-09-01T08:00:00+02:00\":313,\"2021-09-01T09:00:00+02:00\":1061,\"2021-09-01T10:00:00+02:00\":2029,\"2021-09-01T11:00:00+02:00\":2891,\"2021-09-01T12:00:00+02:00\":2851,\"2021-09-01T13:00:00+02:00\":3195,\"2021-09-01T14:00:00+02:00\":3302,\"2021-09-01T15:00:00+02:00\":4936,\"2021-09-01T16:00:00+02:00\":4955,\"2021-09-01T17:00:00+02:00\":4086,\"2021-09-01T18:00:00+02:00\":2757,\"2021-09-01T19:00:00+02:00\":1680,\"2021-09-01T20:00:00+02:00\":592,\"2021-09-01T20:10:00+02:00\":121,\"2021-09-01T20:19:00+02:00\":0,\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":33,\"2021-09-02T07:00:00+02:00\":138,\"2021-09-02T08:00:00+02:00\":599,\"2021-09-02T09:00:00+02:00\":1981,\"2021-09-02T10:00:00+02:00\":3884,\"2021-09-02T11:00:00+02:00\":5697,\"2021-09-02T12:00:00+02:00\":7150,\"2021-09-02T13:00:00+02:00\":8073,\"2021-09-02T14:00:00+02:00\":8374,\"2021-09-02T15:00:00+02:00\":8036,\"2021-09-02T16:00:00+02:00\":7102,\"2021-09-02T17:00:00+02:00\":5651,\"2021-09-02T18:00:00+02:00\":3885,\"2021-09-02T19:00:00+02:00\":2045,\"2021-09-02T20:00:00+02:00\":610,\"2021-09-02T20:09:00+02:00\":121,\"2021-09-02T20:17:00+02:00\":0},\"watt_hours\":{\"2021-09-01T06:31:00+02:00\":0,\"2021-09-01T06:46:00+02:00\":3,\"2021-09-01T07:00:00+02:00\":12,\"2021-09-01T08:00:00+02:00\":325,\"2021-09-01T09:00:00+02:00\":1386,\"2021-09-01T10:00:00+02:00\":3415,\"2021-09-01T11:00:00+02:00\":6306,\"2021-09-01T12:00:00+02:00\":9157,\"2021-09-01T13:00:00+02:00\":12352,\"2021-09-01T14:00:00+02:00\":15654,\"2021-09-01T15:00:00+02:00\":20590,\"2021-09-01T16:00:00+02:00\":25545,\"2021-09-01T17:00:00+02:00\":29631,\"2021-09-01T18:00:00+02:00\":32388,\"2021-09-01T19:00:00+02:00\":34068,\"2021-09-01T20:00:00+02:00\":34660,\"2021-09-01T20:10:00+02:00\":34680,\"2021-09-01T20:19:00+02:00\":34680,\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":8,\"2021-09-02T07:00:00+02:00\":38,\"2021-09-02T08:00:00+02:00\":637,\"2021-09-02T09:00:00+02:00\":2618,\"2021-09-02T10:00:00+02:00\":6502,\"2021-09-02T11:00:00+02:00\":12199,\"2021-09-02T12:00:00+02:00\":19349,\"2021-09-02T13:00:00+02:00\":27422,\"2021-09-02T14:00:00+02:00\":35796,\"2021-09-02T15:00:00+02:00\":43832,\"2021-09-02T16:00:00+02:00\":50934,\"2021-09-02T17:00:00+02:00\":56585,\"2021-09-02T18:00:00+02:00\":60470,\"2021-09-02T19:00:00+02:00\":62515,\"2021-09-02T20:00:00+02:00\":63125,\"2021-09-02T20:09:00+02:00\":63143,\"2021-09-02T20:17:00+02:00\":63143},\"watt_hours_day\":{\"2021-09-01T02:00:00+02:00\":34680,\"2021-09-02T02:00:00+02:00\":63143}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":11}}}");

//        // 11kWp / [2021-09-02 10:26:13]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":33,\"2021-09-02T07:00:00+02:00\":140,\"2021-09-02T08:00:00+02:00\":611,\"2021-09-02T09:00:00+02:00\":2063,\"2021-09-02T10:00:00+02:00\":4078,\"2021-09-02T11:00:00+02:00\":6017,\"2021-09-02T12:00:00+02:00\":7497,\"2021-09-02T13:00:00+02:00\":8502,\"2021-09-02T14:00:00+02:00\":8859,\"2021-09-02T15:00:00+02:00\":8511,\"2021-09-02T16:00:00+02:00\":7497,\"2021-09-02T17:00:00+02:00\":5938,\"2021-09-02T18:00:00+02:00\":4052,\"2021-09-02T19:00:00+02:00\":2101,\"2021-09-02T20:00:00+02:00\":615,\"2021-09-02T20:09:00+02:00\":121,\"2021-09-02T20:17:00+02:00\":0,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":33,\"2021-09-03T07:00:00+02:00\":144,\"2021-09-03T08:00:00+02:00\":606,\"2021-09-03T09:00:00+02:00\":1974,\"2021-09-03T10:00:00+02:00\":3857,\"2021-09-03T11:00:00+02:00\":5645,\"2021-09-03T12:00:00+02:00\":7099,\"2021-09-03T13:00:00+02:00\":8058,\"2021-09-03T14:00:00+02:00\":8405,\"2021-09-03T15:00:00+02:00\":8099,\"2021-09-03T16:00:00+02:00\":7210,\"2021-09-03T17:00:00+02:00\":5780,\"2021-09-03T18:00:00+02:00\":4005,\"2021-09-03T19:00:00+02:00\":2129,\"2021-09-03T20:00:00+02:00\":650,\"2021-09-03T20:08:00+02:00\":132,\"2021-09-03T20:15:00+02:00\":0},\"watt_hours\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":8,\"2021-09-02T07:00:00+02:00\":38,\"2021-09-02T08:00:00+02:00\":649,\"2021-09-02T09:00:00+02:00\":2712,\"2021-09-02T10:00:00+02:00\":6790,\"2021-09-02T11:00:00+02:00\":12807,\"2021-09-02T12:00:00+02:00\":20304,\"2021-09-02T13:00:00+02:00\":28806,\"2021-09-02T14:00:00+02:00\":37665,\"2021-09-02T15:00:00+02:00\":46176,\"2021-09-02T16:00:00+02:00\":53673,\"2021-09-02T17:00:00+02:00\":59611,\"2021-09-02T18:00:00+02:00\":63663,\"2021-09-02T19:00:00+02:00\":65764,\"2021-09-02T20:00:00+02:00\":66379,\"2021-09-02T20:09:00+02:00\":66397,\"2021-09-02T20:17:00+02:00\":66397,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":7,\"2021-09-03T07:00:00+02:00\":38,\"2021-09-03T08:00:00+02:00\":644,\"2021-09-03T09:00:00+02:00\":2618,\"2021-09-03T10:00:00+02:00\":6475,\"2021-09-03T11:00:00+02:00\":12120,\"2021-09-03T12:00:00+02:00\":19219,\"2021-09-03T13:00:00+02:00\":27277,\"2021-09-03T14:00:00+02:00\":35682,\"2021-09-03T15:00:00+02:00\":43781,\"2021-09-03T16:00:00+02:00\":50991,\"2021-09-03T17:00:00+02:00\":56771,\"2021-09-03T18:00:00+02:00\":60776,\"2021-09-03T19:00:00+02:00\":62905,\"2021-09-03T20:00:00+02:00\":63555,\"2021-09-03T20:08:00+02:00\":63573,\"2021-09-03T20:15:00+02:00\":63573},\"watt_hours_day\":{\"2021-09-02T02:00:00+02:00\":66397,\"2021-09-03T02:00:00+02:00\":63573}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":11}}}");
        
//        // 10kWp / [2021-09-02 15:09:29]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":33,\"2021-09-02T07:00:00+02:00\":140,\"2021-09-02T08:00:00+02:00\":611,\"2021-09-02T09:00:00+02:00\":2063,\"2021-09-02T10:00:00+02:00\":4078,\"2021-09-02T11:00:00+02:00\":6017,\"2021-09-02T12:00:00+02:00\":7497,\"2021-09-02T13:00:00+02:00\":8502,\"2021-09-02T14:00:00+02:00\":8859,\"2021-09-02T15:00:00+02:00\":8511,\"2021-09-02T16:00:00+02:00\":7497,\"2021-09-02T17:00:00+02:00\":5938,\"2021-09-02T18:00:00+02:00\":4052,\"2021-09-02T19:00:00+02:00\":2101,\"2021-09-02T20:00:00+02:00\":615,\"2021-09-02T20:09:00+02:00\":121,\"2021-09-02T20:17:00+02:00\":0,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":33,\"2021-09-03T07:00:00+02:00\":144,\"2021-09-03T08:00:00+02:00\":606,\"2021-09-03T09:00:00+02:00\":1974,\"2021-09-03T10:00:00+02:00\":3857,\"2021-09-03T11:00:00+02:00\":5645,\"2021-09-03T12:00:00+02:00\":7099,\"2021-09-03T13:00:00+02:00\":8058,\"2021-09-03T14:00:00+02:00\":8405,\"2021-09-03T15:00:00+02:00\":8099,\"2021-09-03T16:00:00+02:00\":7210,\"2021-09-03T17:00:00+02:00\":5780,\"2021-09-03T18:00:00+02:00\":4005,\"2021-09-03T19:00:00+02:00\":2129,\"2021-09-03T20:00:00+02:00\":650,\"2021-09-03T20:08:00+02:00\":132,\"2021-09-03T20:15:00+02:00\":0},\"watt_hours\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":8,\"2021-09-02T07:00:00+02:00\":38,\"2021-09-02T08:00:00+02:00\":649,\"2021-09-02T09:00:00+02:00\":2712,\"2021-09-02T10:00:00+02:00\":6790,\"2021-09-02T11:00:00+02:00\":12807,\"2021-09-02T12:00:00+02:00\":20304,\"2021-09-02T13:00:00+02:00\":28806,\"2021-09-02T14:00:00+02:00\":37665,\"2021-09-02T15:00:00+02:00\":46176,\"2021-09-02T16:00:00+02:00\":53673,\"2021-09-02T17:00:00+02:00\":59611,\"2021-09-02T18:00:00+02:00\":63663,\"2021-09-02T19:00:00+02:00\":65764,\"2021-09-02T20:00:00+02:00\":66379,\"2021-09-02T20:09:00+02:00\":66397,\"2021-09-02T20:17:00+02:00\":66397,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":7,\"2021-09-03T07:00:00+02:00\":38,\"2021-09-03T08:00:00+02:00\":644,\"2021-09-03T09:00:00+02:00\":2618,\"2021-09-03T10:00:00+02:00\":6475,\"2021-09-03T11:00:00+02:00\":12120,\"2021-09-03T12:00:00+02:00\":19219,\"2021-09-03T13:00:00+02:00\":27277,\"2021-09-03T14:00:00+02:00\":35682,\"2021-09-03T15:00:00+02:00\":43781,\"2021-09-03T16:00:00+02:00\":50991,\"2021-09-03T17:00:00+02:00\":56771,\"2021-09-03T18:00:00+02:00\":60776,\"2021-09-03T19:00:00+02:00\":62905,\"2021-09-03T20:00:00+02:00\":63555,\"2021-09-03T20:08:00+02:00\":63573,\"2021-09-03T20:15:00+02:00\":63573},\"watt_hours_day\":{\"2021-09-02T02:00:00+02:00\":66397,\"2021-09-03T02:00:00+02:00\":63573}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":11}}}");

//        // 9kWp / [2021-09-02 15:13:10]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":27,\"2021-09-02T07:00:00+02:00\":115,\"2021-09-02T08:00:00+02:00\":500,\"2021-09-02T09:00:00+02:00\":1688,\"2021-09-02T10:00:00+02:00\":3337,\"2021-09-02T11:00:00+02:00\":4923,\"2021-09-02T12:00:00+02:00\":6134,\"2021-09-02T13:00:00+02:00\":6956,\"2021-09-02T14:00:00+02:00\":7249,\"2021-09-02T15:00:00+02:00\":6867,\"2021-09-02T16:00:00+02:00\":6083,\"2021-09-02T17:00:00+02:00\":4846,\"2021-09-02T18:00:00+02:00\":3244,\"2021-09-02T19:00:00+02:00\":1691,\"2021-09-02T20:00:00+02:00\":498,\"2021-09-02T20:09:00+02:00\":99,\"2021-09-02T20:17:00+02:00\":0,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":27,\"2021-09-03T07:00:00+02:00\":118,\"2021-09-03T08:00:00+02:00\":495,\"2021-09-03T09:00:00+02:00\":1615,\"2021-09-03T10:00:00+02:00\":3158,\"2021-09-03T11:00:00+02:00\":4636,\"2021-09-03T12:00:00+02:00\":5828,\"2021-09-03T13:00:00+02:00\":6595,\"2021-09-03T14:00:00+02:00\":6862,\"2021-09-03T15:00:00+02:00\":6611,\"2021-09-03T16:00:00+02:00\":5889,\"2021-09-03T17:00:00+02:00\":4723,\"2021-09-03T18:00:00+02:00\":3273,\"2021-09-03T19:00:00+02:00\":1740,\"2021-09-03T20:00:00+02:00\":531,\"2021-09-03T20:08:00+02:00\":108,\"2021-09-03T20:15:00+02:00\":0},\"watt_hours\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":6,\"2021-09-02T07:00:00+02:00\":31,\"2021-09-02T08:00:00+02:00\":531,\"2021-09-02T09:00:00+02:00\":2219,\"2021-09-02T10:00:00+02:00\":5556,\"2021-09-02T11:00:00+02:00\":10479,\"2021-09-02T12:00:00+02:00\":16613,\"2021-09-02T13:00:00+02:00\":23569,\"2021-09-02T14:00:00+02:00\":30818,\"2021-09-02T15:00:00+02:00\":37685,\"2021-09-02T16:00:00+02:00\":43768,\"2021-09-02T17:00:00+02:00\":48614,\"2021-09-02T18:00:00+02:00\":51858,\"2021-09-02T19:00:00+02:00\":53549,\"2021-09-02T20:00:00+02:00\":54047,\"2021-09-02T20:09:00+02:00\":54062,\"2021-09-02T20:17:00+02:00\":54062,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":6,\"2021-09-03T07:00:00+02:00\":31,\"2021-09-03T08:00:00+02:00\":526,\"2021-09-03T09:00:00+02:00\":2141,\"2021-09-03T10:00:00+02:00\":5299,\"2021-09-03T11:00:00+02:00\":9935,\"2021-09-03T12:00:00+02:00\":15763,\"2021-09-03T13:00:00+02:00\":22358,\"2021-09-03T14:00:00+02:00\":29220,\"2021-09-03T15:00:00+02:00\":35831,\"2021-09-03T16:00:00+02:00\":41720,\"2021-09-03T17:00:00+02:00\":46443,\"2021-09-03T18:00:00+02:00\":49716,\"2021-09-03T19:00:00+02:00\":51456,\"2021-09-03T20:00:00+02:00\":51987,\"2021-09-03T20:08:00+02:00\":52002,\"2021-09-03T20:15:00+02:00\":52002},\"watt_hours_day\":{\"2021-09-02T02:00:00+02:00\":54062,\"2021-09-03T02:00:00+02:00\":52002}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":9}}}");

//        // 9kWp / [2021-09-02 16:44:48]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":27,\"2021-09-02T07:00:00+02:00\":115,\"2021-09-02T08:00:00+02:00\":500,\"2021-09-02T09:00:00+02:00\":1688,\"2021-09-02T10:00:00+02:00\":3337,\"2021-09-02T11:00:00+02:00\":4923,\"2021-09-02T12:00:00+02:00\":6134,\"2021-09-02T13:00:00+02:00\":6956,\"2021-09-02T14:00:00+02:00\":7249,\"2021-09-02T15:00:00+02:00\":6867,\"2021-09-02T16:00:00+02:00\":6083,\"2021-09-02T17:00:00+02:00\":4846,\"2021-09-02T18:00:00+02:00\":3223,\"2021-09-02T19:00:00+02:00\":1675,\"2021-09-02T20:00:00+02:00\":491,\"2021-09-02T20:09:00+02:00\":99,\"2021-09-02T20:17:00+02:00\":0,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":27,\"2021-09-03T07:00:00+02:00\":118,\"2021-09-03T08:00:00+02:00\":495,\"2021-09-03T09:00:00+02:00\":1615,\"2021-09-03T10:00:00+02:00\":3158,\"2021-09-03T11:00:00+02:00\":4636,\"2021-09-03T12:00:00+02:00\":5828,\"2021-09-03T13:00:00+02:00\":6595,\"2021-09-03T14:00:00+02:00\":6862,\"2021-09-03T15:00:00+02:00\":6611,\"2021-09-03T16:00:00+02:00\":5889,\"2021-09-03T17:00:00+02:00\":4723,\"2021-09-03T18:00:00+02:00\":3273,\"2021-09-03T19:00:00+02:00\":1740,\"2021-09-03T20:00:00+02:00\":531,\"2021-09-03T20:08:00+02:00\":108,\"2021-09-03T20:15:00+02:00\":0},\"watt_hours\":{\"2021-09-02T06:33:00+02:00\":0,\"2021-09-02T06:47:00+02:00\":6,\"2021-09-02T07:00:00+02:00\":31,\"2021-09-02T08:00:00+02:00\":531,\"2021-09-02T09:00:00+02:00\":2219,\"2021-09-02T10:00:00+02:00\":5556,\"2021-09-02T11:00:00+02:00\":10479,\"2021-09-02T12:00:00+02:00\":16613,\"2021-09-02T13:00:00+02:00\":23569,\"2021-09-02T14:00:00+02:00\":30818,\"2021-09-02T15:00:00+02:00\":37685,\"2021-09-02T16:00:00+02:00\":43768,\"2021-09-02T17:00:00+02:00\":48614,\"2021-09-02T18:00:00+02:00\":51837,\"2021-09-02T19:00:00+02:00\":53512,\"2021-09-02T20:00:00+02:00\":54003,\"2021-09-02T20:09:00+02:00\":54018,\"2021-09-02T20:17:00+02:00\":54018,\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":6,\"2021-09-03T07:00:00+02:00\":31,\"2021-09-03T08:00:00+02:00\":526,\"2021-09-03T09:00:00+02:00\":2141,\"2021-09-03T10:00:00+02:00\":5299,\"2021-09-03T11:00:00+02:00\":9935,\"2021-09-03T12:00:00+02:00\":15763,\"2021-09-03T13:00:00+02:00\":22358,\"2021-09-03T14:00:00+02:00\":29220,\"2021-09-03T15:00:00+02:00\":35831,\"2021-09-03T16:00:00+02:00\":41720,\"2021-09-03T17:00:00+02:00\":46443,\"2021-09-03T18:00:00+02:00\":49716,\"2021-09-03T19:00:00+02:00\":51456,\"2021-09-03T20:00:00+02:00\":51987,\"2021-09-03T20:08:00+02:00\":52002,\"2021-09-03T20:15:00+02:00\":52002},\"watt_hours_day\":{\"2021-09-02T02:00:00+02:00\":54018,\"2021-09-03T02:00:00+02:00\":52002}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":11}}}");

//        // 10kWp / [2021-09-03 07:59:42]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":30,\"2021-09-03T07:00:00+02:00\":133,\"2021-09-03T08:00:00+02:00\":560,\"2021-09-03T09:00:00+02:00\":1858,\"2021-09-03T10:00:00+02:00\":3662,\"2021-09-03T11:00:00+02:00\":5418,\"2021-09-03T12:00:00+02:00\":6835,\"2021-09-03T13:00:00+02:00\":7695,\"2021-09-03T14:00:00+02:00\":7956,\"2021-09-03T15:00:00+02:00\":7603,\"2021-09-03T16:00:00+02:00\":6681,\"2021-09-03T17:00:00+02:00\":5284,\"2021-09-03T18:00:00+02:00\":3629,\"2021-09-03T19:00:00+02:00\":1928,\"2021-09-03T20:00:00+02:00\":588,\"2021-09-03T20:08:00+02:00\":120,\"2021-09-03T20:15:00+02:00\":0,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":30,\"2021-09-04T07:00:00+02:00\":141,\"2021-09-04T08:00:00+02:00\":574,\"2021-09-04T09:00:00+02:00\":1842,\"2021-09-04T10:00:00+02:00\":3584,\"2021-09-04T11:00:00+02:00\":5249,\"2021-09-04T12:00:00+02:00\":6588,\"2021-09-04T13:00:00+02:00\":7433,\"2021-09-04T14:00:00+02:00\":7687,\"2021-09-04T15:00:00+02:00\":7399,\"2021-09-04T16:00:00+02:00\":6604,\"2021-09-04T17:00:00+02:00\":5312,\"2021-09-04T18:00:00+02:00\":3689,\"2021-09-04T19:00:00+02:00\":1978,\"2021-09-04T20:00:00+02:00\":623,\"2021-09-04T20:06:00+02:00\":120,\"2021-09-04T20:12:00+02:00\":0},\"watt_hours\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":7,\"2021-09-03T07:00:00+02:00\":35,\"2021-09-03T08:00:00+02:00\":595,\"2021-09-03T09:00:00+02:00\":2453,\"2021-09-03T10:00:00+02:00\":6115,\"2021-09-03T11:00:00+02:00\":11533,\"2021-09-03T12:00:00+02:00\":18368,\"2021-09-03T13:00:00+02:00\":26063,\"2021-09-03T14:00:00+02:00\":34019,\"2021-09-03T15:00:00+02:00\":41622,\"2021-09-03T16:00:00+02:00\":48303,\"2021-09-03T17:00:00+02:00\":53587,\"2021-09-03T18:00:00+02:00\":57216,\"2021-09-03T19:00:00+02:00\":59144,\"2021-09-03T20:00:00+02:00\":59732,\"2021-09-03T20:08:00+02:00\":59748,\"2021-09-03T20:15:00+02:00\":59748,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":6,\"2021-09-04T07:00:00+02:00\":34,\"2021-09-04T08:00:00+02:00\":608,\"2021-09-04T09:00:00+02:00\":2450,\"2021-09-04T10:00:00+02:00\":6034,\"2021-09-04T11:00:00+02:00\":11283,\"2021-09-04T12:00:00+02:00\":17871,\"2021-09-04T13:00:00+02:00\":25304,\"2021-09-04T14:00:00+02:00\":32991,\"2021-09-04T15:00:00+02:00\":40390,\"2021-09-04T16:00:00+02:00\":46994,\"2021-09-04T17:00:00+02:00\":52306,\"2021-09-04T18:00:00+02:00\":55995,\"2021-09-04T19:00:00+02:00\":57973,\"2021-09-04T20:00:00+02:00\":58596,\"2021-09-04T20:06:00+02:00\":58608,\"2021-09-04T20:12:00+02:00\":58608},\"watt_hours_day\":{\"2021-09-03T02:00:00+02:00\":59748,\"2021-09-04T02:00:00+02:00\":58608}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":11}}}");

//        // 7.125kWp / [2021-09-03 12:15:49]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":21,\"2021-09-03T07:00:00+02:00\":95,\"2021-09-03T08:00:00+02:00\":399,\"2021-09-03T09:00:00+02:00\":1324,\"2021-09-03T10:00:00+02:00\":2609,\"2021-09-03T11:00:00+02:00\":3860,\"2021-09-03T12:00:00+02:00\":4655,\"2021-09-03T13:00:00+02:00\":5300,\"2021-09-03T14:00:00+02:00\":5548,\"2021-09-03T15:00:00+02:00\":5225,\"2021-09-03T16:00:00+02:00\":4652,\"2021-09-03T17:00:00+02:00\":3730,\"2021-09-03T18:00:00+02:00\":2584,\"2021-09-03T19:00:00+02:00\":1372,\"2021-09-03T20:00:00+02:00\":418,\"2021-09-03T20:08:00+02:00\":86,\"2021-09-03T20:15:00+02:00\":0,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":21,\"2021-09-04T07:00:00+02:00\":100,\"2021-09-04T08:00:00+02:00\":408,\"2021-09-04T09:00:00+02:00\":1309,\"2021-09-04T10:00:00+02:00\":2547,\"2021-09-04T11:00:00+02:00\":3731,\"2021-09-04T12:00:00+02:00\":4680,\"2021-09-04T13:00:00+02:00\":5300,\"2021-09-04T14:00:00+02:00\":5519,\"2021-09-04T15:00:00+02:00\":5300,\"2021-09-04T16:00:00+02:00\":4682,\"2021-09-04T17:00:00+02:00\":3732,\"2021-09-04T18:00:00+02:00\":2590,\"2021-09-04T19:00:00+02:00\":1399,\"2021-09-04T20:00:00+02:00\":444,\"2021-09-04T20:06:00+02:00\":86,\"2021-09-04T20:12:00+02:00\":0},\"watt_hours\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":5,\"2021-09-03T07:00:00+02:00\":25,\"2021-09-03T08:00:00+02:00\":424,\"2021-09-03T09:00:00+02:00\":1748,\"2021-09-03T10:00:00+02:00\":4357,\"2021-09-03T11:00:00+02:00\":8217,\"2021-09-03T12:00:00+02:00\":12872,\"2021-09-03T13:00:00+02:00\":18172,\"2021-09-03T14:00:00+02:00\":23720,\"2021-09-03T15:00:00+02:00\":28945,\"2021-09-03T16:00:00+02:00\":33597,\"2021-09-03T17:00:00+02:00\":37327,\"2021-09-03T18:00:00+02:00\":39911,\"2021-09-03T19:00:00+02:00\":41283,\"2021-09-03T20:00:00+02:00\":41701,\"2021-09-03T20:08:00+02:00\":41713,\"2021-09-03T20:15:00+02:00\":41713,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":4,\"2021-09-04T07:00:00+02:00\":24,\"2021-09-04T08:00:00+02:00\":432,\"2021-09-04T09:00:00+02:00\":1741,\"2021-09-04T10:00:00+02:00\":4288,\"2021-09-04T11:00:00+02:00\":8019,\"2021-09-04T12:00:00+02:00\":12699,\"2021-09-04T13:00:00+02:00\":17999,\"2021-09-04T14:00:00+02:00\":23518,\"2021-09-04T15:00:00+02:00\":28818,\"2021-09-04T16:00:00+02:00\":33500,\"2021-09-04T17:00:00+02:00\":37232,\"2021-09-04T18:00:00+02:00\":39822,\"2021-09-04T19:00:00+02:00\":41221,\"2021-09-04T20:00:00+02:00\":41665,\"2021-09-04T20:06:00+02:00\":41674,\"2021-09-04T20:12:00+02:00\":41674},\"watt_hours_day\":{\"2021-09-03T02:00:00+02:00\":41713,\"2021-09-04T02:00:00+02:00\":41674}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":11}}}");
        
//        // 8.25kWp / [2021-09-03 12:29:10]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":50,\"2021-09-03T07:00:00+02:00\":231,\"2021-09-03T08:00:00+02:00\":1082,\"2021-09-03T09:00:00+02:00\":1900,\"2021-09-03T10:00:00+02:00\":2406,\"2021-09-03T11:00:00+02:00\":2665,\"2021-09-03T12:00:00+02:00\":2609,\"2021-09-03T13:00:00+02:00\":2542,\"2021-09-03T14:00:00+02:00\":2362,\"2021-09-03T15:00:00+02:00\":2046,\"2021-09-03T16:00:00+02:00\":1758,\"2021-09-03T17:00:00+02:00\":1552,\"2021-09-03T18:00:00+02:00\":1241,\"2021-09-03T19:00:00+02:00\":864,\"2021-09-03T20:00:00+02:00\":408,\"2021-09-03T20:08:00+02:00\":83,\"2021-09-03T20:15:00+02:00\":0,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":50,\"2021-09-04T07:00:00+02:00\":245,\"2021-09-04T08:00:00+02:00\":1109,\"2021-09-04T09:00:00+02:00\":1897,\"2021-09-04T10:00:00+02:00\":2378,\"2021-09-04T11:00:00+02:00\":2613,\"2021-09-04T12:00:00+02:00\":2665,\"2021-09-04T13:00:00+02:00\":2584,\"2021-09-04T14:00:00+02:00\":2388,\"2021-09-04T15:00:00+02:00\":2116,\"2021-09-04T16:00:00+02:00\":1818,\"2021-09-04T17:00:00+02:00\":1595,\"2021-09-04T18:00:00+02:00\":1276,\"2021-09-04T19:00:00+02:00\":894,\"2021-09-04T20:00:00+02:00\":433,\"2021-09-04T20:06:00+02:00\":91,\"2021-09-04T20:12:00+02:00\":0},\"watt_hours\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":11,\"2021-09-03T07:00:00+02:00\":61,\"2021-09-03T08:00:00+02:00\":1143,\"2021-09-03T09:00:00+02:00\":3043,\"2021-09-03T10:00:00+02:00\":5449,\"2021-09-03T11:00:00+02:00\":8114,\"2021-09-03T12:00:00+02:00\":10723,\"2021-09-03T13:00:00+02:00\":13265,\"2021-09-03T14:00:00+02:00\":15627,\"2021-09-03T15:00:00+02:00\":17673,\"2021-09-03T16:00:00+02:00\":19431,\"2021-09-03T17:00:00+02:00\":20983,\"2021-09-03T18:00:00+02:00\":22224,\"2021-09-03T19:00:00+02:00\":23088,\"2021-09-03T20:00:00+02:00\":23496,\"2021-09-03T20:08:00+02:00\":23507,\"2021-09-03T20:15:00+02:00\":23507,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":10,\"2021-09-04T07:00:00+02:00\":59,\"2021-09-04T08:00:00+02:00\":1168,\"2021-09-04T09:00:00+02:00\":3065,\"2021-09-04T10:00:00+02:00\":5443,\"2021-09-04T11:00:00+02:00\":8056,\"2021-09-04T12:00:00+02:00\":10721,\"2021-09-04T13:00:00+02:00\":13305,\"2021-09-04T14:00:00+02:00\":15693,\"2021-09-04T15:00:00+02:00\":17809,\"2021-09-04T16:00:00+02:00\":19627,\"2021-09-04T17:00:00+02:00\":21222,\"2021-09-04T18:00:00+02:00\":22498,\"2021-09-04T19:00:00+02:00\":23392,\"2021-09-04T20:00:00+02:00\":23825,\"2021-09-04T20:06:00+02:00\":23834,\"2021-09-04T20:12:00+02:00\":23834},\"watt_hours_day\":{\"2021-09-03T02:00:00+02:00\":23507,\"2021-09-04T02:00:00+02:00\":23834}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":9}}}");
        
//        // 9kWp / [2021-09-03 14:27:35]
//        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":27,\"2021-09-03T07:00:00+02:00\":119,\"2021-09-03T08:00:00+02:00\":504,\"2021-09-03T09:00:00+02:00\":1672,\"2021-09-03T10:00:00+02:00\":3296,\"2021-09-03T11:00:00+02:00\":4876,\"2021-09-03T12:00:00+02:00\":5880,\"2021-09-03T13:00:00+02:00\":6695,\"2021-09-03T14:00:00+02:00\":7008,\"2021-09-03T15:00:00+02:00\":6605,\"2021-09-03T16:00:00+02:00\":5881,\"2021-09-03T17:00:00+02:00\":4718,\"2021-09-03T18:00:00+02:00\":3233,\"2021-09-03T19:00:00+02:00\":1710,\"2021-09-03T20:00:00+02:00\":519,\"2021-09-03T20:08:00+02:00\":108,\"2021-09-03T20:15:00+02:00\":0,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":27,\"2021-09-04T07:00:00+02:00\":126,\"2021-09-04T08:00:00+02:00\":515,\"2021-09-04T09:00:00+02:00\":1650,\"2021-09-04T10:00:00+02:00\":3208,\"2021-09-04T11:00:00+02:00\":4698,\"2021-09-04T12:00:00+02:00\":5895,\"2021-09-04T13:00:00+02:00\":6658,\"2021-09-04T14:00:00+02:00\":6918,\"2021-09-04T15:00:00+02:00\":6650,\"2021-09-04T16:00:00+02:00\":5898,\"2021-09-04T17:00:00+02:00\":4719,\"2021-09-04T18:00:00+02:00\":3277,\"2021-09-04T19:00:00+02:00\":1770,\"2021-09-04T20:00:00+02:00\":560,\"2021-09-04T20:06:00+02:00\":108,\"2021-09-04T20:12:00+02:00\":0},\"watt_hours\":{\"2021-09-03T06:34:00+02:00\":0,\"2021-09-03T06:47:00+02:00\":6,\"2021-09-03T07:00:00+02:00\":32,\"2021-09-03T08:00:00+02:00\":536,\"2021-09-03T09:00:00+02:00\":2208,\"2021-09-03T10:00:00+02:00\":5504,\"2021-09-03T11:00:00+02:00\":10380,\"2021-09-03T12:00:00+02:00\":16260,\"2021-09-03T13:00:00+02:00\":22955,\"2021-09-03T14:00:00+02:00\":29963,\"2021-09-03T15:00:00+02:00\":36568,\"2021-09-03T16:00:00+02:00\":42449,\"2021-09-03T17:00:00+02:00\":47167,\"2021-09-03T18:00:00+02:00\":50400,\"2021-09-03T19:00:00+02:00\":52110,\"2021-09-03T20:00:00+02:00\":52629,\"2021-09-03T20:08:00+02:00\":52643,\"2021-09-03T20:15:00+02:00\":52643,\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":5,\"2021-09-04T07:00:00+02:00\":31,\"2021-09-04T08:00:00+02:00\":546,\"2021-09-04T09:00:00+02:00\":2196,\"2021-09-04T10:00:00+02:00\":5404,\"2021-09-04T11:00:00+02:00\":10102,\"2021-09-04T12:00:00+02:00\":15997,\"2021-09-04T13:00:00+02:00\":22655,\"2021-09-04T14:00:00+02:00\":29573,\"2021-09-04T15:00:00+02:00\":36223,\"2021-09-04T16:00:00+02:00\":42121,\"2021-09-04T17:00:00+02:00\":46840,\"2021-09-04T18:00:00+02:00\":50117,\"2021-09-04T19:00:00+02:00\":51887,\"2021-09-04T20:00:00+02:00\":52447,\"2021-09-04T20:06:00+02:00\":52457,\"2021-09-04T20:12:00+02:00\":52457},\"watt_hours_day\":{\"2021-09-03T02:00:00+02:00\":52643,\"2021-09-04T02:00:00+02:00\":52457}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":4}}}");
        
        // 9kWp / [2021-09-04 17:24:47]
        return StageSupport.completedStage("{\"result\":{\"watts\":{\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":27,\"2021-09-04T07:00:00+02:00\":115,\"2021-09-04T08:00:00+02:00\":490,\"2021-09-04T09:00:00+02:00\":1605,\"2021-09-04T10:00:00+02:00\":3164,\"2021-09-04T11:00:00+02:00\":4646,\"2021-09-04T12:00:00+02:00\":5892,\"2021-09-04T13:00:00+02:00\":6553,\"2021-09-04T14:00:00+02:00\":6749,\"2021-09-04T15:00:00+02:00\":6710,\"2021-09-04T16:00:00+02:00\":5979,\"2021-09-04T17:00:00+02:00\":4804,\"2021-09-04T18:00:00+02:00\":3322,\"2021-09-04T19:00:00+02:00\":1767,\"2021-09-04T20:00:00+02:00\":554,\"2021-09-04T20:06:00+02:00\":108,\"2021-09-04T20:12:00+02:00\":0,\"2021-09-05T06:38:00+02:00\":0,\"2021-09-05T06:49:00+02:00\":27,\"2021-09-05T07:00:00+02:00\":119,\"2021-09-05T08:00:00+02:00\":487,\"2021-09-05T09:00:00+02:00\":1518,\"2021-09-05T10:00:00+02:00\":2905,\"2021-09-05T11:00:00+02:00\":4206,\"2021-09-05T12:00:00+02:00\":5248,\"2021-09-05T13:00:00+02:00\":5955,\"2021-09-05T14:00:00+02:00\":6225,\"2021-09-05T15:00:00+02:00\":5889,\"2021-09-05T16:00:00+02:00\":4953,\"2021-09-05T17:00:00+02:00\":3768,\"2021-09-05T18:00:00+02:00\":2626,\"2021-09-05T19:00:00+02:00\":1543,\"2021-09-05T20:00:00+02:00\":564,\"2021-09-05T20:05:00+02:00\":117,\"2021-09-05T20:10:00+02:00\":0},\"watt_hours\":{\"2021-09-04T06:36:00+02:00\":0,\"2021-09-04T06:48:00+02:00\":5,\"2021-09-04T07:00:00+02:00\":28,\"2021-09-04T08:00:00+02:00\":518,\"2021-09-04T09:00:00+02:00\":2123,\"2021-09-04T10:00:00+02:00\":5287,\"2021-09-04T11:00:00+02:00\":9933,\"2021-09-04T12:00:00+02:00\":15825,\"2021-09-04T13:00:00+02:00\":22378,\"2021-09-04T14:00:00+02:00\":29127,\"2021-09-04T15:00:00+02:00\":35837,\"2021-09-04T16:00:00+02:00\":41816,\"2021-09-04T17:00:00+02:00\":46620,\"2021-09-04T18:00:00+02:00\":49942,\"2021-09-04T19:00:00+02:00\":51709,\"2021-09-04T20:00:00+02:00\":52263,\"2021-09-04T20:06:00+02:00\":52274,\"2021-09-04T20:12:00+02:00\":52274,\"2021-09-05T06:38:00+02:00\":0,\"2021-09-05T06:49:00+02:00\":5,\"2021-09-05T07:00:00+02:00\":27,\"2021-09-05T08:00:00+02:00\":514,\"2021-09-05T09:00:00+02:00\":2032,\"2021-09-05T10:00:00+02:00\":4937,\"2021-09-05T11:00:00+02:00\":9143,\"2021-09-05T12:00:00+02:00\":14391,\"2021-09-05T13:00:00+02:00\":20346,\"2021-09-05T14:00:00+02:00\":26571,\"2021-09-05T15:00:00+02:00\":32460,\"2021-09-05T16:00:00+02:00\":37413,\"2021-09-05T17:00:00+02:00\":41181,\"2021-09-05T18:00:00+02:00\":43807,\"2021-09-05T19:00:00+02:00\":45350,\"2021-09-05T20:00:00+02:00\":45914,\"2021-09-05T20:05:00+02:00\":45924,\"2021-09-05T20:10:00+02:00\":45924},\"watt_hours_day\":{\"2021-09-04T02:00:00+02:00\":52274,\"2021-09-05T02:00:00+02:00\":45924}},\"message\":{\"code\":0,\"type\":\"success\",\"text\":\"\",\"info\":{\"latitude\":51.7344,\"longitude\":8.698,\"place\":\"33106 Paderborn, Paderborn, Nordrhein-Westfalen, DE\",\"timezone\":\"Europe/Berlin\"},\"ratelimit\":{\"period\":3600,\"limit\":12,\"remaining\":10}}}");
    }
}
